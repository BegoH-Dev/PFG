version: '3.9'

services:
  # Servicio del frontend - aplicaci√≥n web del cliente
  frontend:
    build: ./frontend
    ports:
      - '3000:3000'
    volumes:
      - ./frontend:/app
    environment:
      - CHOKIDAR_USEPOLLING=true       
    depends_on:
      - backend                         

  # Servicio del backend - API del servidor
  backend:
    build: ./backend                    
    ports:
      - '8000:8000'                    
    volumes:
      - ./backend:/app                 
    environment:
      - DATABASE_URL=postgres://postgres:password@db:5432/mydb 
    depends_on:
      - db                             

  # Servicio de base de datos PostgreSQL
  db:
    image: postgres:14                
    restart: always                    
    environment:
      POSTGRES_USER: postgres          
      POSTGRES_PASSWORD: postgres      
      POSTGRES_DB: restaurante_db     
    volumes:
      - ./database:/docker-entrypoint-initdb.d  
      - db-data:/var/lib/postgresql/data         

volumes:
  db-data:                             